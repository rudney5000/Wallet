# Wallet Service

## Описание
Данное задание нацелено на выявление вашего реального уровня в разработке на Java. Выполняйте его честно и проявите себя по максимуму. Удачи!

Приложение предоставляет REST API для управления кошельками.
Вы можете выполнять операции пополнения и снятия средств, а также получать текущий баланс кошелька.
Должны быть написаны миграции для базы данных с помощью liquibase
Обратите особое внимание проблемам при работе в конкурентной среде (1000 RPS по
одному кошельку). Ни один запрос не должен быть не обработан (50Х error)
Предусмотрите соблюдение формата ответа для заведомо неверных запросов, когда
кошелька не существует, не валидный json, или недостаточно средств.
Приложение должно запускаться в докер контейнере, база данных тоже, вся система
должна подниматься с помощью docker-compose предусмотрите возможность настраивать различные параметры как на стороне
приложения так и базы данных без пересборки контейнеров.
Эндпоинты должны быть покрыты тестами.
Решенное задание залить на гитхаб, предоставить ссылку
Все возникающие вопросы по заданию решать самостоятельно, по своему
усмотрению.
## Технологический стек
- **Java 17**
- **Spring Boot 3**
- **Spring Data JPA**
- **PostgreSQL**
- **Liquibase**
- **Docker**
- **Docker Compose**
- **JUnit 5**
- **Maven**

## Эндпоинты

### POST /api/v1/wallet/new
Создаёт новый кошелёк.

#### Response
```json
{
  "message": "Новый кошелек успешно создан!"
}
```

### GET /api/v1/wallets/{WALLET_ID}
Возвращает баланс указанного кошелька.

#### Response
```json
{
"walletId": "UUID",
"balance": 1000
}
```

### GET /api/v1/wallets
Возвращает список всех кошельков.

#### Response
```json
[
{
"walletId": "UUID",
"balance": 1000
}, 
{
"walletId": "UUID",
"balance": 500   
}
]
```
#### POST /api/v1/wallet
Выполняет операцию над кошельком.

#### Request
```json
{
"walletId": "UUID",
"operationType": "DEPOSIT or WITHDRAW",
"amount": 1000
}
```
#### Response
```json
{
"message": "Выполнение операции успешно завершено!"
}
```
## Как запустить проект

### Предварительные требования

Перед тем как запустить проект, убедитесь, что у вас установлены следующие инструменты:

- **Docker**: Для контейнеризации приложения и базы данных. Установите Docker с официального сайта [docker.com](https://www.docker.com/get-started).
- **Docker Compose**: Для упрощения работы с несколькими контейнерами. Установите Docker Compose с официального сайта [docs.docker.com/compose](https://docs.docker.com/compose/install/).

### Запуск

1. **Клонируйте репозиторий:**
    ```bash
    git clone https://github.com/rudney5000/Wallet.git
    cd Wallet
    ```

2. **Запустите приложение сразу**

## Конфигурация

Все конфигурационные параметры для приложения и базы данных находятся в файлах:

- `src/main/resources/application.yml` - Конфигурация Spring Boot приложения.
- `docker-compose.yml` - Конфигурация Docker Compose для настройки контейнеров.

Вы можете изменять эти файлы для настройки параметров без необходимости пересборки контейнеров.

## Миграции базы данных

Миграции базы данных выполняются автоматически при запуске приложения с помощью Liquibase. Скрипты миграций расположены в папке `src/main/resources/db/changelog`.

## Обработка ошибок

Ошибки возвращаются в формате XML и содержат следующие поля:

- `error_code` - Код ошибки.
- `timestamp` - Время возникновения ошибки.
- `description` - Описание ошибки.
- `tip` - Рекомендации по исправлению ошибки.

## Тестирование

Эндпоинты покрыты тестами. Для запуска тестов выполните команду:

```bash
mvn test
```

## Работа в конкурентной среде
Приложение рассчитано на работу в условиях высокой нагрузки (1000 RPS по одному кошельку). Для обеспечения корректной работы при таком количестве запросов используется встроенный в Spring Boot Tomcat сервер, настроенный на более 1000 одновременных запросов.